from Crypto.Util.number import long_to_bytes
from sympy import mod_inverse, integer_nthroot

# Data hasil yang kamu dapat
capsules = [
    {
        "c": "1F712BE479342C1608802147400199D20821D50D19D32D0A07824B2C4B1E0B24DA2BEF6B28025EDB0A2FBB78D5A0154CE7FDB115103BF5536CD5F7950C1548282FD89752914D5DDDA37439563C2D6A4B2345BCCF279D6DC01D7CCB195EEAFD218AAA89CBF6B0ACF8D9889359BAA40EA111B117DCF96F8AA8C062E97860DAAD9",
        "n": "5B5C55A16A4B826F09D9CA956D07425439B0824DBC426304407BF8455CEBC9C557117F2DB1BD2A971DD863069FE16B2A695970B7771AF2745F49CB8B4EE59081A64B3BD79621F63566D34B7EEDE58C8DEFF9A6EE10EA1D837125B4BC172BB14AEAFC882CC10400C87D6C87AA02B3B1034E7DC38F3AD7CDDF8D586D13DA2E21C3"
    },
    {
        "c": "B9A0FC1C38B07AA9580F2A7DB22610CE0742F2F8A4C7393B04B95A6EA83D30AF2A6EEE7B17C6A32CD7F3181324DE5081067B4798F9B1DB729EDE44FC8498523EC7E5812804C36B05D327FE326BF22483E5795A96F5B2BFCA0EE3345D33F7E1D87D6DF934C094E9B9AD9838C0914E3D80E365A780A68DD76A7B552F8BF1F494F4",
        "n": "DD6B2EE01858ACD1A2C826B7BBFC91B478856B1CA06EF4B6CDFF510610A21E8FFE4DA2A16EB2AC2E41079953B41544102C90A2915F0D41FAA8CB960B5A3B20DDA01DD2C7DFBD4C7214D3A591834F4C0EA035D3C32CADC9BF0976D141968DF55B8F2AB11B36FD168B6099FEF7DA871557555B7575924EB4BF85E7835BF5F47F01"
    },
    {
        "c": "8881799790252C99E8A5466ECD41F291FDE0E0E8A831D8946A10F467C274AF0460C4E66F45B25B4D8A94C758119274A3A467A27C9629CB0313ED26883869FD628D4F9AC4F95AA2F0A1A17BB6F305E48CC113075954E5A11229C543494E81B273CE3AA1D12A1CBA914B2B87297B671ABAD88C18B5F84DE5332FDAE3FFEEFCC1B7",
        "n": "9223ACFB9CF93E81500363423861FB9DBAD011C65340E42FEE5C456F90D1EA8A5DCAC3F0EAD6F28967822DBDAF53310A6A768E31BFDE2C0F606C8FFBD2B4BF543CC4CC4178448FB73406EB4041CA88CF5AB89271AF33F2C653866B3D37EB82D91AE5AD520473721B10F73FD673B7BFCE8239770A52F11F613CB439E14287FC97"
    },
    {
        "c": "9C02648AEAB396CCE48A02F3AA7120D00B1FFE82662F7D92D3DD447515B2198A829CB77951687B7986943CA428E7C421D0B486A6D7713BBD24067F75FBCAB3DC7B19653EBE7BFEA1EDE86CF695D4C2053A2C41D746FF38D7ECC068C76AFD45B1AD348084DC0E377DC3DF6FD8CF2195AEA5E1D87EA507699F1467CD39B90A3DBB",
        "n": "A3588300480C3A3267ECC13D19EB3F38F9A22C7939E8857F0C14AA5521CFFEB94187549B43148ACDAC75265357AD83221B4F6DA3BE508CAF61E4CA8407E0B86DF1F5EE2675A84EAAFEBA840FD33B35243189B6A1037659A3F4D610D515074C043A80215386304FD4D15A355FCEF2336C58AF31277304775F071FA6900D35793D"
    },
    {
        "c": "6B37ECBF30B81CA05D71E89E0445D2779758BE2DC948F69E4E9C24B60A350FC31EDBA4E9E6CAAA06AF8E0E100F08F93842BDFC821FACE22C8F3F9B16877382D691416BBD9A6659A3AA3E835B6992C437C7E8BF7844B24463F346B347D632A24DADAAC3900E169FCBC6523D8D305B5BE912C123C9DA47156D2D6B6118E5202BDF",
        "n": "95F9F550273570F2E5E7AF2A818412E3ABBCCA6F14F12C3848DDF979C62D8092F67E5B783FCB8426E1E0A40C69CB7655A652FD6C56DD27FE36D17010DF6C87FC4A67D327D027C0BF3B1C7238FF5CC8813599123C79FF96808A45231B359ECB5AFE0C007B2C0B04D3B3C9620FD0E691741D0A16D22E6C3AA0787B0F270CA7A7A7"
    }
]

e = 5

# Convert hex to int
c_list = [int(x["c"], 16) for x in capsules]
n_list = [int(x["n"], 16) for x in capsules]

# Chinese Remainder Theorem
def crt(remainders, moduli):
    N = 1
    for n in moduli:
        N *= n
    result = 0
    for r, n in zip(remainders, moduli):
        m = N // n
        result += r * m * mod_inverse(m, n)
    return result % N

C = crt(c_list, n_list)

# Hitung akar ke-5 dari C
m, exact = integer_nthroot(C, e)

print("[*] Flag (hex):", hex(m))
print("[*] Flag (ascii):", long_to_bytes(m))
